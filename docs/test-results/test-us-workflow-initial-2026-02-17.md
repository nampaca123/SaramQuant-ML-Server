# US 워크플로우 초기실행 테스트 결과 (2026-02-17)

## 실행 환경

| 항목 | 값 |
|---|---|
| OS | Windows 10 (10.0.26200) |
| Python | 3.14.3 |
| DB | Supabase PostgreSQL (Transaction Pooler) |
| 실행 방식 | `python -m app.pipeline us-initial` |

## 단계별 소요시간

### `python -m app.pipeline us-initial` — 총 13분 26초

| 단계 | 시작 | 종료 | 소요 | 비고 |
|---|---|---|---|---|
| 종목 목록 수집 | 16:51:15 | 16:51:17 | **2초** | NYSE 2,039 + NASDAQ 3,854 = 5,893종목 |
| 섹터 수집 | 16:51:17 | 16:58:42 | **7분 25초** | NasdaqScreener 90건 + Finnhub fallback 55건 = 145건 |
| 일봉 수집 | 16:58:42 | 17:01:40 | **2분 58초** | Alpaca API 118배치, 5,889종목 일괄 |
| 벤치마크 수집 | 17:01:40 | 17:01:42 | **2초** | S&P500 + NASDAQ 지수 |
| 무위험이자율 수집 | 17:01:42 | 17:01:49 | **7초** | 91D, 3Y, 10Y (FRED API) |
| 재무제표 수집 | 17:01:49 | 17:03:24 | **1분 35초** | Remote collector, 45,954건 |
| 비활성화 | 17:03:24 | 17:03:32 | **8초** | no-price 4 / no-sector 276 / no-FS 1,238 → 4,375 활성 |
| 펀더멘털 계산 | 17:03:32 | 17:04:00 | **28초** | 4,375종목 |
| 팩터 모델 | 17:04:00 | 17:04:03 | **3초** | NYSE 21팩터 + NASDAQ 23팩터 |
| 지표 계산 | 17:04:03 | 17:04:39 | **36초** | 4,334종목 |
| 섹터 집계 | 17:04:39 | 17:04:39 | **< 1초** | 44건 |
| 무결성 검사 | 17:04:39 | 17:04:41 | **2초** | PASS (no_fs 경고 있음, 아래 참조) |

## 데이터 수집 현황

| 테이블 | 건수 |
|---|---|
| stocks | 5,893 |
| daily_prices | 1,512,591 |
| stock_indicators | 4,334 |
| financial_statements | 45,954 |
| stock_fundamentals | 4,375 |
| factor_exposures | 4,369 |
| factor_returns | 44 (NYSE 21 + NASDAQ 23) |
| sector_aggregates | 44 |
| benchmark_daily_prices | 3,084 (기존 KR 포함) |
| risk_free_rates | 19,244 (기존 KR 포함) |

## 데이터 품질 검증

### 필터링

| 항목 | 결과 | 판정 |
|---|---|---|
| 이상 가격 (close <= 0 또는 high < low) | 6건 (BENFW, MLECW, PLRZ) | WARN |

- 6건 모두 워런트(BENFW, MLECW) 또는 초저가 종목(PLRZ)의 close=0.00 레코드. 소수점 이하 가격의 반올림 문제로 추정.

### 커버리지

| 마켓 | 활성 종목 | 일봉 보유 | 지표 계산 | 펀더멘털 | 팩터 노출도 |
|---|---|---|---|---|---|
| US_NYSE | 1,586 | 1,586 (100%) | 1,580 (99.6%) | 1,586 (100%) | 1,586 (100%) |
| US_NASDAQ | 2,789 | 2,789 (100%) | 2,754 (98.7%) | 2,789 (100%) | 2,783 (99.8%) |

- 지표 미계산 41종목: 일봉 60일 미만 종목
- 팩터 노출도 미계산 6종목 (NASDAQ): 모든 style factor가 NaN인 종목으로 추정

### 비활성화 현황

| 사유 | NYSE | NASDAQ | 합계 |
|---|---|---|---|
| no-price | 0 | 4 | 4 |
| no-sector | 33 | 243 | 276 |
| no-FS | 420 | 818 | 1,238 |
| **활성** | **1,586** | **2,789** | **4,375 (74.2%)** |

- 비활성률 25.8%: KR(5.7%)보다 높음. 주로 NASDAQ 소형주 중 재무제표 미보유(EDGAR 미등록/비표준 보고) 종목.

### 팩터 수익률

| 마켓 | 팩터 수 | 구성 |
|---|---|---|
| US_NYSE | 21 | market(1) + style(6) + industry(14) |
| US_NASDAQ | 23 | market(1) + style(6) + industry(16) |

- 6개 스타일 팩터 전부 포함 (momentum 포함)
- NYSE와 NASDAQ의 industry 수 차이: 거래소별 상장 업종 구성이 다름 (NASDAQ: Biotechnology, Automobiles, Food Products, Packaging 등 고유 업종)

### 팩터 노출도 항목별 채움률 (4,369건 기준)

| 항목 | 건수 | 비율 | 비고 |
|---|---|---|---|
| size | 3,732 | 85.4% | shares_outstanding 미보유 |
| value | 3,307 | 75.7% | PBR 미보유 |
| momentum | 4,113 | 94.1% | 252일 미만 |
| volatility | 4,349 | 99.5% | |
| quality | 1,471 | 33.7% | ROE/영업이익률 미보유 |
| leverage | 3,720 | 85.2% | debt_ratio 미보유 |

- KR(size 100%, quality 89.9%) 대비 전반적으로 낮음. US 재무제표(SEC EDGAR) 특성상 shares_outstanding·ROE 등의 항목 누락률이 높음.

### 펀더멘털 항목별 채움률 (4,375건 기준)

| 항목 | 건수 | 비율 |
|---|---|---|
| PER | 1,278 | 29.2% |
| PBR | 3,309 | 75.6% |
| EPS | 1,278 | 29.2% |
| ROE | 1,479 | 33.8% |
| 부채비율 | 3,720 | 85.0% |
| 영업이익률 | 1,509 | 34.5% |

- PER/EPS 29.2%: 적자 기업 제외 + SEC 보고서 항목 매핑 누락 복합 영향
- KR(PER 89.9%) 대비 현저히 낮음. US FS 수집기의 항목 매핑 개선 필요.

### 일봉 가격일 분포

| 구간 | 종목 수 | 비율 |
|---|---|---|
| 252일 이상 | 4,113 | 94.0% |
| 60~251일 | 221 | 5.1% |
| 60일 미만 | 41 | 0.9% |

- 최대 273일 / 최소 2일 / 평균 264일

### 기간

| 데이터 | 시작일 | 종료일 | 거래일 수 |
|---|---|---|---|
| 일봉 | 2025-01-14 | 2026-02-13 | 273일 |
| 벤치마크 (S&P500/NASDAQ) | 2020-01-02 | 2026-02-13 | 1,504일 |
| 무위험이자율 | 2000-01-04 | 2026-02-13 | 19,244건 |

## 무결성 검사 경고

IntegrityCheck에서 `no_fs=10` (NYSE) / `no_fs=7` (NASDAQ) 경고 발생.
DB 확인 결과 17종목이 `data_coverage = 'INSUFFICIENT'` 상태로 활성 유지 중.

| 마켓 | 종목 | 비고 |
|---|---|---|
| US_NYSE | BRO, CNK, DKL, HI, MNR, NGL, SGU, TVC, TVE, UAN | LP(합자회사)·우선주·비표준 보고 종목 |
| US_NASDAQ | ANGI, AVAV, BCTX, LYTS, PAL, SCHL, SSM | 비표준 회계연도 종목 |

- 비활성화 단계에서 `NO_FS`만 필터하고 `INSUFFICIENT`는 통과시키는 구조. 실질적 영향은 미미하나, 펀더멘털 기반 지표의 정확도에 경미한 영향 가능.

## 발견 사항 요약

| 항목 | 심각도 | 내용 |
|---|---|---|
| 이상 가격 6건 | LOW | 워런트/초저가 종목의 close=0. 수집 단계에서 volume=0 필터로 대부분 차단되나 일부 누수 |
| 펀더멘털 채움률 낮음 | MEDIUM | PER 29%, ROE 34%. US FS 수집기의 항목 매핑 개선 필요 |
| INSUFFICIENT 종목 미비활성화 | LOW | 17종목. deactivate_no_fs가 `NO_FS`만 필터하고 `INSUFFICIENT` 미포함 |
| 섹터 수집 소요시간 | INFO | Finnhub fallback 403종목에 7분 소요 (rate limit). 전체 시간의 55% 차지 |
